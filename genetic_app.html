<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Genetic app</title>

    <style>

.orig-1 {
    background-color: rgb(250, 234, 197);
}

.orig-2{
    background-color: rgb(230, 250, 197);
}

.orig-3{
    background-color: rgb(197, 230, 250);
}

.orig-4{
    background-color: rgb(226, 197, 250);
}

table.t1 {
    border: 1px solid black;
    border-collapse: collapse;
}

table.t1 tr {
    border: 1px solid black;
}

table.t1 th {
    background-color: rgb(0, 0, 255);
    color: rgb(51, 255, 0)
}

table.t1 th, table.t1 td{
    border: 1px solid black;
    padding: 5px;
}

    </style>

</head>
<body>
    <h1>Genetic app</h1>
    <form id="tg_form">

<table>
<tr>
    <td>
        <label>Initial number of individuals (min 2):</label>
    </td>
    <td>
        <input name="start_n" type="number" min="2" max="30" value="2" required />
    </td>
</tr>

<tr>
    <td>
        <label>Max number of individuals (min 4):</label>
    </td>
    <td>
        <input name="max_n" type="number" min="4" max="45" value="15" required />
    </td>
</tr>

<tr>
    <td>
        <label>Number of individuals generated by crossing-over (in each generation):</label>
    </td>
    <td>
        <input name="number_by_crossing" type="number" min="0" max="30" value="10" required />
    </td>
</tr>

<tr>
    <td>
        <label>Number of individuals generated by mutation (in each generation):</label>
    </td>
    <td>
        <input name="number_by_mutation" type="number" min="0" max="30" value="2" required />
    </td>
</tr>

<tr>
    <td>
        <label>Number of individuals generated by cloning (in each generation):</label>
    </td>
    <td>
        <input name="number_by_cloning" type="number" min="0" max="30" value="1" required />
    </td>
</tr>

<tr>
    <td>
        <label for="tg_form_selected_function_id">Function to minimize:</label>
    </td>
    <td>
        <select name="selected_function_id" id="tg_form_selected_function_id">
            <option value="0">time * cost</option>
            <option value="1">time</option>
            <option value="2">cost</option>
        </select>
    </td>
</tr>
</table>

        <br/>
        <br/>
        <label for="tg_form_tg_source_ta">Task graph:</label>
        <br/>
        <textarea id="tg_form_tg_source_ta" name="tg_source" style="width: 500px; height: 300px;" required>
@tasks 20
T0 5 1(0) 2(0) 3(0) 4(0) 5(0)   #This is a comment.
T1 0 
T2 5 6(0) 7(0) 8(0) 9(0) 12(0) 
T3 1 9(0) 
T4 0 
T5 2 18(0) 19(0) 
T6 1 9(0) 
T7 0 
T8 2 10(0) 11(0) 
T9 0 
T10 0 
T11 0 
T12 5 13(0) 14(0) 15(0) 16(0) 17(0) 
T13 0 
T14 0 
T15 0 
T16 0 
T17 0 
T18 0 
T19 0 
@proc 4
285 0 1 
118 0 1 
0 0 0 
0 0 0 
@times 
841 693 65 58 
646 595 70 42 
776 637 6 22 
663 335 57 54 
714 785 76 70 
729 684 69 15 
662 55 27 66 
71 897 64 51 
697 868 46 36 
350 923 3 26 
60 679 30 27 
536 337 50 69 
636 587 43 51 
388 519 27 16 
270 852 81 17 
432 752 9 55 
693 76 70 6 
412 805 32 53 
692 636 34 15 
824 511 69 11 
@cost 
5 40 328 293 
48 54 104 46 
10 11 142 405 
7 69 255 183 
61 24 265 319 
31 5 47 392 
12 97 260 330 
71 36 76 111 
54 53 225 370 
55 48 75 385 
56 17 350 145 
42 67 364 99 
17 22 273 175 
8 23 157 213 
66 56 209 253 
14 47 459 159 
38 65 280 153 
19 32 73 367 
12 60 219 345 
25 2 257 178 
@comm 1
CHAN0 59 10 1 1 1 1 
        </textarea>
        <br/>
        <button type="submit">Start genetic</button>
    </form>

    <div id="genetic_app_root" style="display: none;"> </div>

    <script type="module">
        console.log("Hello world");

        import {readTaskGraph} from "./task_graph.js";
        import {GeneticApp} from "./genetic_app.js";

        let tg_form = document.getElementById("tg_form");
        let genetic_app_root = document.getElementById("genetic_app_root");

        tg_form.onsubmit = function(event){
            event.preventDefault();
            let fd = new FormData(event.target);
            let tg_source = fd.get("tg_source");

            let task_graph = null;
            try{
                task_graph = readTaskGraph(tg_source);
            }
            catch(e){
                alert(e);
                return;
            }

            let start_n = Number.parseInt(fd.get("start_n"));
            let max_n = Number.parseInt(fd.get("max_n"));
            let number_by_crossing = Number.parseInt(fd.get("number_by_crossing"));
            let number_by_mutation = Number.parseInt(fd.get("number_by_mutation"));
            let number_by_cloning = Number.parseInt(fd.get("number_by_cloning"));

            let score_func = null;
            let selected_function_id = Number.parseInt(fd.get("selected_function_id"));


            switch(selected_function_id){
            case 0:
                score_func = function(time, cost){
                    return time * cost;
                }
                break;
            case 1:
                score_func = function(time, cost){
                    return time;
                }
                break;
            case 2:
                score_func = function(time, cost){
                    return cost;
                }
                break;
            }

            let app = new GeneticApp(genetic_app_root, task_graph, score_func,start_n, max_n,
            number_by_crossing, number_by_mutation, number_by_cloning);

            app.render();

            tg_form.style.display = "none";
            genetic_app_root.style.display = null;
        }

    </script>
</body>
</html>